<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Αγόρασε Άδεια POSPal - Σύστημα POS για Εστιατόρια</title>
    <link rel="icon" href="app_icon.ico">
    <script src="https://js.stripe.com/v3/"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .brand-600 { color: #059669; }
        .gradient-bg { background: linear-gradient(135deg, #059669 0%, #047857 100%); }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand': {
                            600: '#059669',
                            700: '#047857'
                        },
                        'accent': {
                            500: '#10b981'
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-gray-50 to-white">
    
    <!-- Header -->
    <header class="relative z-50 bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-3">
                    <img src="app_icon.ico" alt="POSPal Logo" class="w-10 h-10 rounded-xl">
                    <span class="text-2xl font-bold text-gray-900">POSPal</span>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="text-gray-600 hover:text-brand-600 font-medium transition-colors">Αρχική</a>
                    <a href="POSPal_Demo_Index.html" class="text-gray-600 hover:text-brand-600 font-medium transition-colors">Demo</a>
                    <a href="index.html#pricing" class="text-gray-600 hover:text-brand-600 font-medium transition-colors">Τιμή</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <section class="py-12 lg:py-20">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <!-- Page Title -->
            <div class="text-center mb-12 lg:mb-16 fade-in-up">
                <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-6">
                    Αγόρασε <span class="text-brand-600">Άδεια POSPal</span>
                </h1>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    Πλήρες σύστημα POS για την επιχείρησή σου - Εφάπαξ πληρωμή, δικό σου για πάντα
                </p>
            </div>

            <!-- Important Notice -->
            <div class="max-w-4xl mx-auto mb-16 fade-in-up">
                <div class="bg-red-50 border border-red-200 rounded-2xl p-8">
                    <div class="flex items-start">
                        <i class="fas fa-exclamation-triangle text-red-600 text-2xl mt-1 mr-6 flex-shrink-0"></i>
                        <div>
                            <h3 class="text-2xl font-bold text-red-800 mb-4">Σημαντικό - Διάβασε προσεκτικά!</h3>
                            <div class="grid md:grid-cols-3 gap-6 text-red-700">
                                <div>
                                    <h4 class="font-semibold mb-2">📧 Email Παράδοση</h4>
                                    <p class="text-sm">Η άδεια θα σταλεί στο email που θα δηλώσεις. Ελέγξτε το προσεκτικά!</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">🔒 Hardware ID</h4>
                                    <p class="text-sm">Πρέπει να είναι 100% σωστό - η άδεια δουλεύει μόνο σε αυτόν τον υπολογιστή.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold mb-2">⚠️ Μη Αλλάξιμο</h4>
                                    <p class="text-sm">Δεν μπορούμε να αλλάξουμε το Hardware ID μετά την αγορά.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div class="grid xl:grid-cols-3 gap-8 lg:gap-12">
                
                <!-- License Info Sidebar -->
                <div class="xl:col-span-1 fade-in-up">
                    <div class="bg-white p-8 rounded-2xl shadow-lg border border-gray-100 sticky top-8">
                        <div class="text-center mb-8">
                            <div class="text-6xl font-bold text-brand-600 mb-3">€290</div>
                            <div class="text-gray-500 text-lg">Εφάπαξ πληρωμή</div>
                        </div>
                        
                        <ul class="space-y-4">
                            <li class="flex items-center text-gray-700">
                                <i class="fas fa-check text-accent-500 mr-4 text-lg"></i>
                                <span>Πλήρες σύστημα POS</span>
                            </li>
                            <li class="flex items-center text-gray-700">
                                <i class="fas fa-check text-accent-500 mr-4 text-lg"></i>
                                <span>QR μενού & online παραγγελίες</span>
                            </li>
                            <li class="flex items-center text-gray-700">
                                <i class="fas fa-check text-accent-500 mr-4 text-lg"></i>
                                <span>Εκτυπώσεις & αναφορές</span>
                            </li>
                            <li class="flex items-center text-gray-700">
                                <i class="fas fa-check text-accent-500 mr-4 text-lg"></i>
                                <span>Δωρεάν ενημερώσεις</span>
                            </li>
                            <li class="flex items-center text-gray-700">
                                <i class="fas fa-check text-accent-500 mr-4 text-lg"></i>
                                <span>Χωρίς μηνιαίες χρεώσεις</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Purchase Form -->
                <div class="xl:col-span-2 fade-in-up">
                    <div class="bg-white rounded-2xl shadow-lg border border-gray-100">
                        
                        <!-- Form Header -->
                        <div class="p-8 pb-0">
                            <h2 class="text-3xl font-bold text-gray-900 mb-2">Στοιχεία Αγοράς</h2>
                            <p class="text-gray-600">Συμπλήρωσε τα στοιχεία σου για να προχωρήσεις στην πληρωμή</p>
                        </div>
                        
                        <!-- Form -->
                        <form id="license-form" class="p-8">
                            
                            <!-- Personal Info Section -->
                            <div class="mb-12">
                                <h3 class="text-xl font-semibold text-gray-900 mb-6">Προσωπικά Στοιχεία</h3>
                                <div class="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-3">Όνομα *</label>
                                        <input 
                                            type="text" 
                                            id="customer-name" 
                                            required 
                                            class="w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-600 focus:border-brand-600 transition-colors text-lg"
                                            placeholder="Το όνομά σας"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-3">Όνομα Επιχείρησης (Προαιρετικό)</label>
                                        <input 
                                            type="text" 
                                            id="restaurant-name" 
                                            class="w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-600 focus:border-brand-600 transition-colors text-lg"
                                            placeholder="π.χ. Καφετέρια Ακρόπολις"
                                        >
                                    </div>
                                </div>
                            </div>

                            <!-- Email Section -->
                            <div class="mb-12">
                                <h3 class="text-xl font-semibold text-gray-900 mb-3">Email Παράδοσης</h3>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                    <p class="text-blue-800 text-sm flex items-center">
                                        <i class="fas fa-info-circle mr-2"></i>
                                        <strong>Η άδειά σου θα σταλεί στο email που θα δηλώσεις. Ελέγξτε το προσεκτικά!</strong>
                                    </p>
                                </div>
                                <div class="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-3">
                                            Email * <span class="text-red-600">(Εδώ θα σταλεί η άδεια)</span>
                                        </label>
                                        <input 
                                            type="email" 
                                            id="customer-email" 
                                            required 
                                            class="w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-600 focus:border-brand-600 transition-colors text-lg"
                                            placeholder="email@example.com"
                                        >
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-3">
                                            Επιβεβαίωση Email * <span class="text-red-600">(Ξαναγράψε)</span>
                                        </label>
                                        <input 
                                            type="email" 
                                            id="customer-email-confirm" 
                                            required 
                                            class="w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-600 focus:border-brand-600 transition-colors text-lg"
                                            placeholder="email@example.com (ξανά)"
                                        >
                                    </div>
                                </div>
                            </div>

                            <!-- Hardware ID Section -->
                            <div class="mb-8">
                                <h3 class="text-xl font-semibold text-gray-900 mb-3">Hardware ID</h3>
                                
                                <!-- Hardware ID Instructions -->
                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-6 mb-6">
                                    <div class="flex items-start">
                                        <i class="fas fa-laptop text-amber-600 text-2xl mr-4 mt-1"></i>
                                        <div>
                                            <h4 class="font-semibold text-amber-800 mb-3">Πώς να βρεις το Hardware ID:</h4>
                                            <ol class="text-amber-700 space-y-2">
                                                <li><strong>1.</strong> Κατέβασε και άνοιξε το POSPal</li>
                                                <li><strong>2.</strong> Πήγαινε στο <strong>Διαχείριση → Άδεια</strong></li>
                                                <li><strong>3.</strong> Κάνε κλικ <strong>"Αντίγραψε"</strong> δίπλα στο Hardware ID</li>
                                                <li><strong>4.</strong> Κόλλησε το <strong>ΟΛΟΚΛΗΡΟ</strong> στο πεδίο παρακάτω</li>
                                            </ol>
                                            <p class="text-amber-800 mt-4 font-semibold">
                                                ⚠️ ΠΡΟΣΟΧΗ: Αν το Hardware ID είναι λάθος, η άδεια ΔΕΝ θα δουλέψει!
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-3">
                                        Hardware ID * <span class="text-red-600">(Πρέπει να είναι 100% σωστό!)</span>
                                    </label>
                                    <textarea 
                                        id="hardware-id" 
                                        required 
                                        rows="4"
                                        class="w-full px-4 py-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-600 focus:border-brand-600 transition-colors text-lg font-mono"
                                        placeholder="Κόλλησε εδώ το Hardware ID από την εφαρμογή POSPal..."
                                    ></textarea>
                                </div>
                            </div>
                            
                            <!-- Error Message -->
                            <div id="error-message" class="hidden bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-lg mb-8"></div>
                            
                            <!-- Submit Button -->
                            <div class="border-t border-gray-200 pt-8">
                                <button 
                                    type="submit" 
                                    id="checkout-button"
                                    class="w-full bg-brand-600 text-white py-5 rounded-xl text-xl font-semibold hover:bg-brand-700 transition-colors inline-flex items-center justify-center"
                                >
                                    <i class="fas fa-shopping-cart mr-3"></i>
                                    Αγόρασε τώρα - €290
                                </button>
                                
                                <div class="flex items-center justify-center space-x-8 pt-6 text-sm text-gray-500">
                                    <div class="flex items-center">
                                        <i class="fas fa-lock mr-2 text-green-600"></i>
                                        Ασφαλής πληρωμή με Stripe
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-envelope mr-2 text-blue-600"></i>
                                        Άμεση παράδοση στο email
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Support -->
            <div class="text-center mt-16">
                <div class="max-w-2xl mx-auto">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">Χρειάζεσαι βοήθεια;</h3>
                    <p class="text-gray-600 mb-6">
                        Αν αντιμετωπίζεις δυσκολία στο να βρεις το Hardware ID ή έχεις οποιαδήποτε ερώτηση, 
                        μη διστάσεις να επικοινωνήσεις μαζί μας.
                    </p>
                    <a 
                        href="mailto:support@pospal.gr" 
                        class="inline-flex items-center px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium"
                    >
                        <i class="fas fa-envelope mr-2"></i>
                        support@pospal.gr
                    </a>
                </div>
            </div>
            
        </div>
    </section>
    
    <script>
        // Initialize Stripe (replace with your publishable key)
        const stripe = Stripe('pk_test_51S2bGO0ee6hGru1PcQXsgn6AvCPqDGqVwZ9AuON37wN3EQpsLNCSCMlpLC4U3xVAda7zgL2D4ifbT1TSXn0PJtbL00b1W7wxZT');
        
        const form = document.getElementById('license-form');
        const checkoutButton = document.getElementById('checkout-button');
        const errorMessage = document.getElementById('error-message');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const customerName = document.getElementById('customer-name').value.trim();
            const customerEmail = document.getElementById('customer-email').value.trim();
            const customerEmailConfirm = document.getElementById('customer-email-confirm').value.trim();
            const hardwareId = document.getElementById('hardware-id').value.trim();
            const restaurantName = document.getElementById('restaurant-name').value.trim();
            
            // Validate form
            if (!customerName || !customerEmail || !customerEmailConfirm || !hardwareId) {
                showError('Παρακαλώ συμπλήρωσε όλα τα απαιτούμενα πεδία.');
                return;
            }
            
            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(customerEmail)) {
                showError('Παρακαλώ εισάγαγε έγκυρη διεύθυνση email.');
                return;
            }
            
            // Validate emails match
            if (customerEmail !== customerEmailConfirm) {
                showError('Τα emails δεν ταιριάζουν! Παρακαλώ ελέγξτε τα και ξαναδοκιμάστε.');
                return;
            }
            
            // Enhanced Hardware ID validation
            if (hardwareId.length < 20) {
                showError('Το Hardware ID φαίνεται πολύ μικρό. Παρακαλώ αντίγραψε το ΠΛΗΡΕΣ Hardware ID από την εφαρμογή POSPal (Διαχείριση → Άδεια → Αντίγραψε).');
                return;
            }
            
            // Check if it looks like a real hardware ID (contains alphanumeric characters)
            if (!/^[A-Za-z0-9\-_\s]+$/.test(hardwareId)) {
                showError('Το Hardware ID περιέχει μη έγκυρους χαρακτήρες. Παρακαλώ αντίγραψε το από την εφαρμογή POSPal χρησιμοποιώντας το κουμπί "Αντίγραψε".');
                return;
            }
            
            // Show loading state
            checkoutButton.disabled = true;
            checkoutButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i>Δημιουργία πληρωμής...';
            hideError();
            
            try {
                // Create Stripe Checkout Session
                const response = await fetch('/api/create-checkout-session', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        customerName,
                        customerEmail,
                        hardwareId,
                        restaurantName,
                        priceAmount: 29000, // €290.00 in cents
                        currency: 'eur'
                    }),
                });
                
                if (!response.ok) {
                    throw new Error('Αποτυχία δημιουργίας πληρωμής');
                }
                
                const session = await response.json();
                
                // Redirect to Stripe Checkout
                const { error } = await stripe.redirectToCheckout({
                    sessionId: session.id
                });
                
                if (error) {
                    throw new Error(error.message);
                }
                
            } catch (error) {
                console.error('Checkout error:', error);
                showError('Αποτυχία έναρξης πληρωμής. Παρακαλώ δοκίμασε ξανά ή επικοινώνησε με την υποστήριξη.');
            } finally {
                checkoutButton.disabled = false;
                checkoutButton.innerHTML = '<i class="fas fa-shopping-cart mr-3"></i>Αγόρασε τώρα - €290';
            }
        });
        
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
            errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function hideError() {
            errorMessage.classList.add('hidden');
        }
        
        // Auto-format Hardware ID textarea
        document.getElementById('hardware-id').addEventListener('input', function(e) {
            const value = e.target.value;
            const cleaned = value.replace(/\s+/g, ' ').trim();
            
            if (cleaned !== value) {
                e.target.value = cleaned;
            }
        });
    </script>
    
</body>
</html>