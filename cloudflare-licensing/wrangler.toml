name = "pospal-licensing-v2"
main = "src/index.js"
compatibility_date = "2024-08-31"

# Default local development configuration (no environment specified)
[[d1_databases]]
binding = "DB"
database_name = "pospal-subscriptions-dev"
database_id = "62f81f71-2c41-4c60-bd74-649aa619f2fc"

[vars]
ENVIRONMENT = "development"
STRIPE_PRICE_ID = "price_1S2vQN0ee6hGru1PTberJVcZ"
TRIAL_DURATION_DAYS = "30"

# Production environment
[env.production]

# D1 Database binding
[[env.production.d1_databases]]
binding = "DB"
database_name = "pospal-subscriptions"
database_id = "2f0fd6ad-4886-4348-ab6b-9f98087e76f9"

# Environment variables for production (set via wrangler secret put)
[env.production.vars]
ENVIRONMENT = "production"
STRIPE_PRICE_ID = "price_1S26QQ1HM7SuDGcMAqFI7r9C"
TRIAL_DURATION_DAYS = "30"
# Renewal reminders window (days before billing)
RENEWAL_REMINDER_WINDOW_DAYS = "5"
# Secrets are set via: wrangler secret put STRIPE_SECRET_KEY --env production
# Secrets are set via: wrangler secret put STRIPE_WEBHOOK_SECRET --env production
# Secrets are set via: wrangler secret put RESEND_API_KEY --env production

# Development environment
[env.development]

[[env.development.d1_databases]]
binding = "DB"
database_name = "pospal-subscriptions-dev"
database_id = "62f81f71-2c41-4c60-bd74-649aa619f2fc"

[env.development.vars]
ENVIRONMENT = "development"
# Set development secrets via: wrangler secret put STRIPE_SECRET_KEY --env development
# Set development secrets via: wrangler secret put STRIPE_WEBHOOK_SECRET --env development
# Set development secrets via: wrangler secret put RESEND_API_KEY --env development
STRIPE_PRICE_ID = "price_1S2vQN0ee6hGru1PTberJVcZ"
TRIAL_DURATION_DAYS = "30"
RENEWAL_REMINDER_WINDOW_DAYS = "5"

# Workers routes (configure these later)
# [[env.production.routes]]
# pattern = "license.pospal.gr/*"

# [[env.development.routes]]  
# pattern = "license-dev.pospal.gr/*"
